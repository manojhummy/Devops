Absolutely! Here’s your **final consolidated observability notes** in a clean, interview-ready format:

---

# Observability Tools – Final Notes

## 1. Prometheus (Metrics Database)

* Open-source metrics collection and monitoring tool.
* Pull model: scrapes targets at intervals (default 15s).
* Stores data in a time-series database.
* Query using PromQL.
* Exposes its own metrics at port 9090.
* Common targets: Node Exporter, cAdvisor, MySQL Exporter.

Interview line:
"Prometheus collects and stores metrics, scrapes targets on intervals, and lets me query them using PromQL."

---

## 2. Node Exporter (Metrics Agent)

* Runs on Linux servers, exposes system metrics on port 9100.
* Collects CPU, memory, disk, and network metrics.
* Prometheus scrapes Node Exporter for system-level metrics.

Interview line:
"Node Exporter is an agent that collects Linux system metrics and exposes them to Prometheus on port 9100."

---

## 3. Loki (Logs Database)

* Log aggregation system by Grafana Labs.
* Works like Prometheus but for logs.
* Lightweight: indexes labels only (not full log content).
* Query using LogQL.
* Typically runs on port 3100.

Interview line:
"Loki is a log aggregation system that stores logs efficiently by indexing only labels, and we query logs using LogQL."

---

## 4. Promtail (Logs Agent)

* Agent that runs on servers/containers.
* Reads log files (/var/log/\*, container logs).
* Adds labels like instance, job, env.
* Pushes logs to Loki.

Interview line:
"Promtail is the log collector that reads server or container logs, labels them, and pushes them into Loki."

---

## 5. Grafana (Visualization & Dashboarding)

* Open-source dashboard and visualization tool.
* Connects to Prometheus (metrics) and Loki (logs).
* Supports alerts and notifications (Slack, email, PagerDuty).
* Does not store data, only queries and visualizes.

Interview line:
"Grafana visualizes both metrics and logs from Prometheus and Loki, providing a single observability dashboard."

---

## Observability Flow

1. Node Exporter → exposes Linux metrics on port 9100.
2. Prometheus → scrapes Node Exporter and other targets every 15s, stores metrics.
3. Promtail → reads logs, adds labels, pushes to Loki.
4. Loki → stores and indexes logs by labels.
5. Grafana → queries both Prometheus and Loki, shows dashboards for metrics and logs.

Analogy:
Prometheus = Metrics DB
Node Exporter = Metrics Agent
Loki = Logs DB
Promtail = Logs Agent
Grafana = Visualization and Alerts

---

## Typical Ports

* Prometheus → 9090
* Node Exporter → 9100
* Loki → 3100
* Promtail → runs locally, pushes logs
* Grafana → 3000

---

## Sample PromQL Queries (Metrics)

* Check target health: `up{job='prometheus'}`
* CPU idle: `node_cpu_seconds_total{job=~"client1|client2", mode="idle"}`
* CPU usage %: `100 - (avg by(instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)`
* Free memory (MB): `node_memory_MemFree_bytes{job=~"client1|client2"} / 1024 / 1024`
* Memory alert: `node_memory_MemFree_bytes{job=~"client1|client2"} / 1024 /1024 < 400`
* Disk usage %: `(node_filesystem_size_bytes{job="client1"} - node_filesystem_avail_bytes{job="client1"}) / node_filesystem_size_bytes{job="client1"} * 100`

---

## Sample LogQL Queries (Logs)

* Show all logs: `{job="appserver1"}`
* Filter by keyword: `{job="appserver1"} |= "ERROR"`
* Exclude keyword: `{job="appserver1"} != "DEBUG"`
* Count log lines over time: `count_over_time({job="appserver1"}[5m])`
* Alert on error rate: `sum(rate({job="appserver1"} |= "ERROR"[1m])) > 5`

Interview explanation:
"In Prometheus, I query CPU, memory, disk using PromQL, and define alert conditions like memory < 400 MB. For logs, using Loki with LogQL, I filter logs by labels and keywords, count logs over time, and define error alerts."

---

## Final Interview Summary

"In the observability stack, Prometheus with Node Exporter handles metrics, and Loki with Promtail handles logs. Prometheus scrapes metrics on port 9100, Loki receives logs from Promtail, and Grafana visualizes both metrics and logs. Together, this provides full observability including dashboards and alerts."

